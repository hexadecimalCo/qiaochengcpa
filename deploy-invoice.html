<style type="text/css">
  .iframe-container {
    width: 100%;
    height: auto;
    position: relative;
  }

  .iframe-container iframe {
    width: 100%;
    height: 100px;
    border: none;
  }
</style>

<div class="iframe-container">
  <iframe
    id="insurance-frame"
    allowfullscreen=""
    frameborder="0"
    loading="lazy"
    src="https://16n.com.tw/qiaochengcpa/invoice.html"
    title="保險業務介紹頁面"
  >
    您的瀏覽器不支援內嵌框架 (iframe)。
  </iframe>
</div>

<script>
  $(document).ready(function () {
    // ==========================================================
    // 1. 執行 DOM 結構修改 (隱藏側邊欄並將主內容滿版)
    // ==========================================================
    // $(".category-wrapper .container .row .col-sm-3").hide();
    // $(".category-wrapper .container .row .col-sm-9")
    //   .removeClass("col-sm-9")
    //   .addClass("col-sm-12");

    // ==========================================================
    // 2. 實現 IFRAME 自動高度的程式碼
    // ==========================================================

    // 設置安全來源 (子頁面的網域)
    const IFRAME_ORIGIN = "https://16n.com.tw";
    const $iframe = $("#insurance-frame");
    const $iframeContainer = $(".iframe-container"); // 獲取容器

    // 監聽來自任何子視窗的 postMessage 訊息
    $(window).on("message", function (event) {
      // jQuery 事件對象需要使用 originalEvent 來獲取原生 message 事件對象
      const nativeEvent = event.originalEvent;

      // 檢查訊息來源安全性
      if (nativeEvent.origin !== IFRAME_ORIGIN) {
        return;
      }

      const data = nativeEvent.data;

      // 檢查訊息內容是否包含高度資訊
      if (typeof data.frameHeight !== "undefined") {
        const newHeight = data.frameHeight;

        $iframe.css("height", newHeight);
        $iframeContainer.css("height", newHeight);
      }
    });
  });
</script>
